<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid Repetitive Calculations in Python using cached_property | Blas Fern√°ndez</title>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css"> 
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="canonical" href="https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/static/img/favicons/site.webmanifest">
    <link rel="mask-icon" href="/static/img/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ebf4ff">
    <meta name="theme-color" content="#ffffff">
    <link rel="alternate" type="application/rss+xml" href="https://blasferna.com/rss.xml" title="Blas Fern√°ndez | Paraguayan Software Engineer üáµüáæ, working with Python, Java, PostgreSQL, MySQL, Oracle, Django, React, JavaScript, FastAPI and more.">

    <meta property="og:url" content="https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en">
    <meta property="og:title" content="Avoid Repetitive Calculations in Python using cached_property">
    <meta property="og:image" content="https://blasferna.com/static/img/og/en/avoid-repetitive-calculations-in-python-using-cached-property.png">
    <meta property="og:description" content="Learn how to use cached_property in Python to improve performance by avoiding repetitive calculations.">
    <meta property="og:site_name" content="blasferna.com">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@blasfernac">
    <meta name="twitter:domain" content="blasferna.com">
    <meta name="twitter:image" content="https://blasferna.com/static/img/og/en/avoid-repetitive-calculations-in-python-using-cached-property.png">
    <meta name="twitter:site" content="@blasfernac">

    <meta name="google-site-verification" content="pKib3Ovl4PJS_GBqfD-lonlXZaFC9v4rGuKQyOpMQ3Y" />
    <script src="/static/js/theme.js"></script>

    
<meta name="description" content="Learn how to use cached_property in Python to improve performance by avoiding repetitive calculations.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark-dimmed.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/django.min.js"></script>
<style>
    .hljs {
        color: #adbac7;
        background: var(--tw-prose-pre-bg);
    }

    .dark .hljs {
        color: #d4d4d4;
        background: var(--tw-prose-pre-invert-bg);
    }
</style>

</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-50">

    <header class="flex items-center justify-between py-10 max-w-3xl mx-auto px-4 sm:px-0">
        <div>
            <a aria-label="BlasBlog" href="/">
                <div class="flex">
                    <div class="mr-3">
                        <img class="rounded-full h-8 dark:brightness-900" src="/static/img/site_logo.png"></img>
                    </div>
                    
                    <div class="h-6 hidden sm:block text-2xl font-semibold">Blas Fern√°ndez</div>
                    
                </div>
            </a>
        </div>
        <div class="flex items-center text-base leading-5">
            <div class="hidden sm:block">
                <a class="p-1 font-medium sm:p-4" href="/">Home</a>
                <a class="p-1 font-medium sm:p-4" href="/articles">Articles</a>
                <a class="p-1 font-medium sm:p-4" href="/projects">Projects</a>
            </div>
            <div class="relative text-left ml-5">
                <div>
                  <button id="languageButton" type="button" class="inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none dark:bg-gray-800 dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:text-white dark:text-gray-200" aria-haspopup="true" aria-expanded="false">
                    <span class="mr-1">-----</span>
                    <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M10 12a1 1 0 01-.707-.293l-3-3a1 1 0 011.414-1.414L10 9.586l2.293-2.293a1 1 0 011.414 1.414l-3 3A1 1 0 0110 12z" clip-rule="evenodd" />
                    </svg>
                  </button>
                </div>
                <div id="languageList" class="origin-top-right absolute right-0 mt-2 w-28 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 hidden dark:bg-gray-800 dark:border-gray-700">
                  <div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="languageButton">
                    <a href="#" data-lang="en" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-50 dark:hover:bg-gray-700 dark:hover:text-white" role="menuitem">English</a>
                    <a href="#" data-lang="es" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-50 dark:hover:bg-gray-700 dark:hover:text-white" role="menuitem">Espa√±ol</a>
                  </div>
                </div>
            </div>
            <div class="theme-switcher ml-3 mr-2">
                <a href="javascript:void(0)" id="theme-switcher" class="font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 sun-icon hidden">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 moon-icon hidden">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                    </svg>
                </a> 
            </div>
            <div class="sm:hidden text-gray-900 dark:text-white">
                <button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" id="openMenu" aria-label="Toggle Menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <div class="fixed top-0 left-0 z-20 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out translate-x-full dark:bg-gray-800" id="hiddenMenu">
                    <div class="flex justify-end">
                        <button type="button" id="closeMenu" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    fill-rule="evenodd"
                                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                    clip-rule="evenodd"
                                ></path>
                            </svg>
                        </button>
                    </div>
                    <nav class="fixed mt-8 h-full">
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest" href="/">Home</a></div>
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest" href="/articles">Articles</a></div>
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest" href="/projects">Projects</a></div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <main>
        
    <div class="px-4 sm:px-6 md:px-8">
        <div class="max-w-3xl mx-auto">
            <p class="text-sm leading-6 text-slate-700 dark:text-slate-400">November 3, 2024</p>
            <h1 class="text-2xl mt-2 font-extrabold tracking-tight text-slate-900 md:text-3xl dark:text-white">Avoid Repetitive Calculations in Python using cached_property</h1>          
            <div class="mt-6">
                <ul class="flex flex-wrap text-sm leading-6 -mt-6 -mx-5">
                  <li class="flex items-center font-medium whitespace-nowrap px-5 mt-6">
                    <img
                      src="/static/img/profile.jpeg"
                      alt=""
                      class="mr-3 w-9 h-9 rounded-full bg-slate-50"
                      decoding="async"
                    />
                    <div class="text-sm leading-4">
                      <div class="text-slate-900 dark:text-slate-100">Blas Fern√°ndez</div>
                      <div class="mt-1">
                        <a
                          href="https://github.com/blasferna"
                          class="text-sky-500 hover:text-sky-600 dark:hover:text-sky-400 transition-colors"
                        >
                          @<!-- -->blasferna</a
                        >
                      </div>
                    </div>
                  </li>
                </ul>
            </div>
            
            <div class="flex flex-wrap gap-2 mt-6 font-normal">
              
                <a href="/articles/python" class="text-sm px-3 py-1 bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-100 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700">
                  #python
                </a>
              
                <a href="/articles/performance" class="text-sm px-3 py-1 bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-100 rounded-full hover:bg-gray-300 dark:hover:bg-gray-700">
                  #performance
                </a>
              
            </div>
            
            <div class="mt-6 mb-12 prose prose-slate max-w-none dark:prose-invert">
              <div class="flex items-center justify-between mb-4">
    <aside aria-label="Share social media">
      <a href="https://twitter.com/intent/tweet?text=Avoid Repetitive Calculations in Python using cached_property - Blas Fern√°ndez https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/" class="inline-flex items-center px-3 py-2 mr-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg class="w-4 h-4 mr-2" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
          </svg>
          Tweet
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/" class="inline-flex items-center px-3 py-2 mr-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg class="w-4 h-4 mr-2" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path>
          </svg>
          Share
      </a>
      <button type="button" class="copy-button inline-flex items-center px-3 py-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4 mr-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
          </svg>
          copy URL
      </button>
    </aside>
</div>
              <p>Let's suppose we have a class that needs to perform some operations, such as calculations or database queries, within a custom attribute. A common approach might look like the following:</p>
<pre><code class="language-python">import time

class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age

    @property
    def information(self):
        # Performing costly operations here
        result = self.calculate_complex_information()
        return f&quot;Name: {self.name}, Age: {self.age}, Info: {result}&quot;

    def calculate_complex_information(self):
        # Simulate a costly calculation or a database query
        time.sleep(2)  # Simulate a 2-second delay
        return &quot;Calculated information&quot;


if __name__ == &quot;__main__&quot;:
    print(&quot;Starting...&quot;)
    p = Person(&quot;John&quot;, 30)
    # Takes 2 seconds to display the information
    print(p.information)
    # Takes 2 seconds again to display the information
    print(p.information)
</code></pre>
<p>However, this approach has a problem: every time we access the <code>information</code> attribute, all the costly operations will be executed again, which can be inefficient if we access this property frequently. This can lead to inefficient application performance, especially if the operation is particularly slow or if the property is accessed multiple times.</p>
<p>This is where the <code>cached_property</code> utility, available within Python‚Äôs standard library from version 3.8, can help.</p>
<p>This utility allows us to cache the result of a property, thus avoiding unnecessary repetitive calculations. It works similarly to a regular property but with the advantage that the value is calculated only once and stored for future calls. Let‚Äôs see how we can implement this in our previous example:</p>
<pre><code class="language-python">import time
from functools import cached_property

class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age

    @cached_property
    def information(self):
        # Performing costly operations here
        result = self.calculate_complex_information()
        return f&quot;Name: {self.name}, Age: {self.age}, Info: {result}&quot;

    def calculate_complex_information(self):
        # Simulate a costly calculation or a database query
        time.sleep(2)  # Simulate a 2-second delay
        return &quot;Calculated information&quot;


if __name__ == &quot;__main__&quot;:
    print(&quot;Starting...&quot;)
    p = Person(&quot;John&quot;, 30)
    # Takes 2 seconds to display the information the first time
    print(p.information)
    # Returns immediately regardless of the number of calls
    print(p.information)
    print(p.information)
</code></pre>
<p>In this modified example, we replaced the <code>@property</code> decorator with <code>@cached_property</code>. Now, when we access the <code>information</code> property for the first time, the costly calculation will be performed and the result will be stored. On subsequent calls, the cached value will be returned without needing to recalculate.</p>
              <div class="mt-10">
              <div class="flex items-center justify-between mb-4">
    <aside aria-label="Share social media">
      <a href="https://twitter.com/intent/tweet?text=Avoid Repetitive Calculations in Python using cached_property - Blas Fern√°ndez https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/" class="inline-flex items-center px-3 py-2 mr-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg class="w-4 h-4 mr-2" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
          </svg>
          Tweet
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://blasferna.com/articles/avoid-repetitive-calculations-in-python-using-cached-property/" class="inline-flex items-center px-3 py-2 mr-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg class="w-4 h-4 mr-2" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path>
          </svg>
          Share
      </a>
      <button type="button" class="copy-button inline-flex items-center px-3 py-2 text-xs font-medium text-gray-900 no-underline bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4 mr-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
          </svg>
          copy URL
      </button>
    </aside>
</div>
              </div>
            </div>
            
            <div class="giscus mb-10 mt-6"></div>
            
        </div>
    </div>

    </main>

    <footer class="max-w-3xl mx-auto">
        <div class="border-t border-gray-100 pb-16 pt-10 dark:border-gray-800">
            <div class="relative px-4 sm:px-8 lg:px-12">
                <div class="mx-auto max-w-2xl lg:max-w-5xl">
                    <div class="flex flex-col items-center justify-between gap-6">
                        <div class="flex gap-6 text-sm font-medium text-gray-800 dark:text-gray-200">
                            <a class="transition" href="/">Home</a>
                            <a class="transition" href="/articles">Articles</a>
                            <a class="transition" href="/projects">Projects</a>
                            <a class="transition" href="https://github.com/blasferna/blasferna.com">Source</a>
                            <a class="transition" target="_blank" rel="noopener nofollow" href="/rss.xml">RSS</a>
                        </div>
                        <p class="text-sm text-gray-500 dark:text-gray-400">
                            ¬©
                            <!-- -->2024<!-- -->
                            Blas Fern√°ndez. All rights reserved.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        const i18n = {
            urlCopied: "URL copied!"
        }
    </script>
    <script src="/static/js/main.js"></script>
    
<script>
    hljs.highlightAll();
</script>

<script src="https://giscus.app/client.js"
        data-repo="blasferna/blasferna.com"
        data-repo-id="R_kgDOJdq81g"
        data-category="General"
        data-category-id="DIC_kwDOJdq81s4Cjc8U"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<script>
  document.addEventListener('themeChange', ({ detail }) => {
    const theme = detail.theme;
    const iframe = document.querySelector('.giscus-frame');
    const script = document.querySelector('script[src="https://giscus.app/client.js"]');

    if (script) { 
      script.setAttribute('data-theme', theme);
    }

    if (iframe) { 
      let url = new URL(iframe.src);
      url.searchParams.set('theme', theme);
      iframe.src = url.toString();
    }
  });
</script>


</body>
</html>