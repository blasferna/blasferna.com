<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatically convert a website to dark mode | Blas Fernández</title>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css"> 
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/static/img/favicons/site.webmanifest">
    <link rel="mask-icon" href="/static/img/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark-dimmed.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/django.min.js"></script>
<style>
    .hljs {
        color: #adbac7;
        background: var(--tw-prose-pre-bg);
    }
</style>

</head>
<body>

    <header class="flex items-center justify-between py-10 max-w-3xl mx-auto px-4 sm:px-0">
        <div>
            <a aria-label="BlasBlog" href="/en/">
                <div class="flex items-center justify-between">
                    <div class="mr-3">
                        <img class="rounded-full h-9" src="/static/img/site_logo.png"></img>
                    </div>
                    <div class="h-6 hidden sm:block text-2xl font-semibold">Blas Fernández</div>
                </div>
            </a>
        </div>
        <div class="flex items-center text-base leading-5">
            <div class="hidden sm:block">
                <a class="p-1 font-medium text-gray-900 sm:p-4" href="/en/">Home</a>
                <a class="p-1 font-medium text-gray-900 sm:p-4" href="/en/articles1.html">Articles</a>
                <a class="p-1 font-medium text-gray-900 sm:p-4" href="/en/projects.html">Projects</a>
            </div>
            <div class="relative text-left">
                <div>
                  <button id="languageButton" type="button" class="inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none" aria-haspopup="true" aria-expanded="false">
                    <span class="mr-1">-----</span>
                    <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M10 12a1 1 0 01-.707-.293l-3-3a1 1 0 011.414-1.414L10 9.586l2.293-2.293a1 1 0 011.414 1.414l-3 3A1 1 0 0110 12z" clip-rule="evenodd" />
                    </svg>
                  </button>
                </div>
                <div id="languageList" class="origin-top-right absolute right-0 mt-2 w-28 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 hidden">
                  <div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="languageButton">
                    <a href="#" data-lang="en" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900" role="menuitem">English</a>
                    <a href="#" data-lang="es" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900" role="menuitem">Español</a>
                  </div>
                </div>
            </div>
            <div class="sm:hidden">
                <button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" id="openMenu" aria-label="Toggle Menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <div class="fixed top-0 left-0 z-20 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out translate-x-full" id="hiddenMenu">
                    <div class="flex justify-end">
                        <button type="button" id="closeMenu" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900">
                                <path
                                    fill-rule="evenodd"
                                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                    clip-rule="evenodd"
                                ></path>
                            </svg>
                        </button>
                    </div>
                    <nav class="fixed mt-8 h-full">
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900" href="/en/">Home</a></div>
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900" href="/en/articles1.html">Articles</a></div>
                        <div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900" href="/en/projects.html">Projects</a></div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <main>
        
    <div class="px-4 sm:px-6 md:px-8">
        <div class="max-w-3xl mx-auto">
            <p class="text-sm leading-6 text-slate-700">June 11, 2022</p>
            <h1 class="text-2xl mt-2 font-extrabold tracking-tight text-slate-900 md:text-3xl ">Automatically convert a website to dark mode</h1>
            <div class="mt-6">
                <ul class="flex flex-wrap text-sm leading-6 -mt-6 -mx-5">
                  <li class="flex items-center font-medium whitespace-nowrap px-5 mt-6">
                    <img
                      src="/static/img/profile.jpeg"
                      alt=""
                      class="mr-3 w-9 h-9 rounded-full bg-slate-50"
                      decoding="async"
                    />
                    <div class="text-sm leading-4">
                      <div class="text-slate-900">Blas Fernández</div>
                      <div class="mt-1">
                        <a
                          href="https://github.com/blasferna"
                          class="text-sky-500 hover:text-sky-600"
                        >
                          @<!-- -->blasferna</a
                        >
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            
            <div class="mt-12 mb-12 prose prose-slate max-w-none">
                <p><img alt="Screenshot" src="https://user-images.githubusercontent.com/8385910/173192842-488c18b5-16e9-42bd-8af8-f296502385dc.png" /></p>
<p>A few days ago I had the need to apply the dark mode to a website and I didn't want to spend a lot of time in the conversion process, so I started looking for a utility to facilitate the process, luckily I found <a href="https://github.com/darkreader/darkreader">Darkreader</a> an open source browser plugin that automatically applies dark mode.</p>
<p>Inquiring into the functionalities it offers, I found that it can be applied to a website using it as a javascript library, directly from a CDN or installed from NPM.</p>
<p>Today I bring a guide on how to apply it using its CDN version.</p>
<h2>Dependencies</h2>
<ul>
<li><a href="https://github.com/darkreader/darkreader">Darkreader</a></li>
</ul>
<h2>Converting to dark mode</h2>
<p>Add the dependency in the head of the HTML</p>
<pre><code class="language-html">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/darkreader@4.9.46/darkreader.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Create the toggle button to apply dark mode</p>
<pre><code class="language-html">&lt;input type=&quot;checkbox&quot; id=&quot;dark-switch&quot;&gt;
</code></pre>
<p>For the mode change to be persistent, it is necessary to store the user's preference in the browser's Local Storage.</p>
<p>Get user preference from Local Storage.</p>
<pre><code class="language-javascript">  const getCurrentMode = function () {
    let mode = localStorage.getItem(&quot;mode&quot;);
    if (!mode) {
      mode = &quot;light&quot;;
    }
    return mode;
  };
</code></pre>
<p>Function to change the mode according to the preference stored in the browser.</p>
<pre><code class="language-javascript">  const changeMode = function (toggler) {
    let mode = getCurrentMode();
    if (toggler) {
      toggler.checked = mode === &quot;dark&quot;;
    }
    if (mode === &quot;dark&quot;) {
      DarkReader.setFetchMethod(window.fetch);
      DarkReader.enable({
        brightness: 100,
        contrast: 90,
        sepia: 10,
      });
    } else {
      DarkReader.disable();
    }
  };
</code></pre>
<p>The following function allows the toggler to be configured to apply the user's preference based on change events.</p>
<pre><code class="language-javascript"> const configure = function () {
    const darkSwitch = document.getElementById(&quot;dark-switch&quot;);
    if (darkSwitch) {
      darkSwitch.addEventListener(&quot;change&quot;, function (e) {
        if (darkSwitch.checked) {
          localStorage.setItem(&quot;mode&quot;, &quot;dark&quot;);
        } else {
          localStorage.setItem(&quot;mode&quot;, &quot;light&quot;);
        }
        changeMode(darkSwitch);
      });
    }
    changeMode(darkSwitch);
  };
</code></pre>
<p>The following block of code allows the change to be applied safely without the user feeling the screen flicker when the library is making the change.</p>
<pre><code class="language-javascript">  function ready(fn) {
    if (document.readyState !== &quot;loading&quot;) {
      fn();
    } else {
      document.addEventListener(&quot;DOMContentLoaded&quot;, fn);
    }
  }

  ready(function () {
    configure();
  });

  changeMode();
</code></pre>
<p>Create a <code>dark_mode.js</code> file to include all the code explained above:</p>
<pre><code class="language-javascript">(function () {
  const getCurrentMode = function () {
    let mode = localStorage.getItem(&quot;mode&quot;);
    if (!mode) {
      mode = &quot;light&quot;;
    }
    return mode;
  };

  const changeMode = function (toggler) {
    let mode = getCurrentMode();
    if (toggler) {
      toggler.checked = mode === &quot;dark&quot;;
    }
    if (mode === &quot;dark&quot;) {
      DarkReader.setFetchMethod(window.fetch);
      DarkReader.enable({
        brightness: 100,
        contrast: 90,
        sepia: 10,
      });
    } else {
      DarkReader.disable();
    }
  };

  const configure = function () {
    const darkSwitch = document.getElementById(&quot;dark-switch&quot;);
    if (darkSwitch) {
      darkSwitch.addEventListener(&quot;change&quot;, function (e) {
        if (darkSwitch.checked) {
          localStorage.setItem(&quot;mode&quot;, &quot;dark&quot;);
        } else {
          localStorage.setItem(&quot;mode&quot;, &quot;light&quot;);
        }
        changeMode(darkSwitch);
      });
    }
    changeMode(darkSwitch);
  };

  function ready(fn) {
    if (document.readyState !== &quot;loading&quot;) {
      fn();
    } else {
      document.addEventListener(&quot;DOMContentLoaded&quot;, fn);
    }
  }

  ready(function () {
    configure();
  });

  changeMode();
})();
</code></pre>
<p>Finally add the <code>dark_mode.js</code> in the HTML head block.</p>
<pre><code class="language-javascript">&lt;script type=&quot;text/javascript&quot;  src=&quot;./dark_mode.js&quot;&gt;&lt;/script&gt;
</code></pre>
<h2>Demo</h2>
<p>You can see the code in action by accessing the following link <a href="https://blasferna.github.io/auto-dark-mode/">https://blasferna.github.io/auto-dark-mode/</a></p>
<h3>Source</h3>
<p>The demo page source code is available on <a href="https://github.com/blasferna/auto-dark-mode">Github</a> with more details on how to apply it to a web site.</p>
            </div>

        </div>
    </div>

    </main>

    <footer class="max-w-3xl mx-auto">
        <div class="border-t border-gray-100 pb-16 pt-10">
            <div class="relative px-4 sm:px-8 lg:px-12">
                <div class="mx-auto max-w-2xl lg:max-w-5xl">
                    <div class="flex flex-col items-center justify-between gap-6 sm:flex-row">
                        <div class="flex gap-6 text-sm font-medium text-gray-800">
                            <a class="transition" href="/en/">Home</a>
                            <a class="transition" href="/en/articles1.html">Articles</a>
                            <a class="transition" href="/en/projects.html">Projects</a>
                        </div>
                        <p class="text-sm text-gray-500">
                            ©
                            <!-- -->2023<!-- -->
                            Blas Fernández. All rights reserved.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="/static/js/main.js"></script>
    
<script>
    hljs.highlightAll();
</script>

</body>
</html>